<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Yamanote Line Immersive Guide</title>
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; img-src 'self' data: https://images.unsplash.com https://media.timeout.com https://upload.wikimedia.org https://cdn.pixabay.com; media-src 'self' https://madewithonlyai.com https://cdn.pixabay.com; style-src 'self' 'unsafe-inline'; font-src 'self' https://fonts.gstatic.com; script-src 'self'; connect-src 'self';">
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div id="app" class="app">
    <header class="top-bar">
      <button id="mapToggle" class="ghost-button" aria-expanded="false">Map</button>
      <div class="search-wrapper">
        <label class="sr-only" for="stationSearch">Search stations</label>
        <input id="stationSearch" list="stationList" type="search" placeholder="Search stations…" autocomplete="off">
        <datalist id="stationList"></datalist>
        <button id="jumpButton" class="ghost-button">Go</button>
      </div>
      <div class="top-actions">
        <button id="rideModeButton" class="ghost-button" aria-pressed="true">Ride Mode On</button>
        <button id="ambientToggle" class="ghost-button" aria-pressed="false">Ambient Off</button>
      </div>
    </header>

    <main id="stationViewport" class="station-viewport" tabindex="0">
      <div id="stationBackground" class="station-background" role="img" aria-live="polite"></div>
      <div class="station-backdrop"></div>

      <div id="prevStationPreview" class="station-preview station-preview--previous" aria-hidden="true"></div>
      <div id="nextStationPreview" class="station-preview station-preview--next" aria-hidden="true"></div>

      <section class="station-content">
        <div class="station-titles">
          <h1 id="stationNameJp" class="station-title station-title--jp" lang="ja"></h1>
          <p id="stationNameEn" class="station-title station-title--en"></p>
        </div>
        <article class="station-info" aria-live="polite">
          <h2 class="station-info__heading">About</h2>
          <p id="stationAbout" class="station-info__body"></p>
        </article>
        <section class="transfer-lines" aria-label="Transfer lines">
          <h3 class="transfer-lines__heading">Transfers</h3>
          <div id="transferLines" class="transfer-lines__list"></div>
        </section>
      </section>

      <div class="audio-panel" role="region" aria-label="Station announcements">
        <div class="audio-panel__controls">
          <button id="playPause" class="control-button" aria-pressed="false">▶</button>
          <button id="skipStation" class="control-button" aria-label="Skip to next station">⏭</button>
        </div>
        <div class="audio-panel__meta">
          <span id="currentTrackLabel" class="track-label"></span>
          <label class="volume-control" for="volumeSlider">
            <span class="sr-only">Announcement volume</span>
            <input id="volumeSlider" type="range" min="0" max="1" step="0.01">
          </label>
          <button id="muteButton" class="ghost-button" aria-pressed="false">Mute</button>
        </div>
      </div>
    </main>

    <nav class="mobile-dock" aria-label="Mobile controls">
      <button id="mobilePlay" class="dock-button" aria-pressed="false">▶</button>
      <button id="mobileSkip" class="dock-button" aria-label="Skip to next">⏭</button>
      <button id="mobileMap" class="dock-button" aria-expanded="false">Map</button>
    </nav>

    <aside id="mapOverlay" class="map-overlay" aria-hidden="true">
      <div class="map-overlay__inner">
        <button id="closeMap" class="ghost-button map-overlay__close" aria-label="Close map">×</button>
        <h2 class="map-overlay__title">Yamanote Loop</h2>
        <svg id="loopMap" viewBox="0 0 600 600" role="img" aria-label="Interactive map of the Yamanote Line"></svg>
      </div>
    </aside>
  </div>

  <audio id="announcementAudio" preload="auto" crossorigin="anonymous"></audio>
  <audio id="ambientAudio" preload="auto" loop crossorigin="anonymous" src="https://cdn.pixabay.com/audio/2022/03/15/audio_54c178aeb5.mp3"></audio>

  <script src="main.js" type="module"></script>
</body>
</html>
